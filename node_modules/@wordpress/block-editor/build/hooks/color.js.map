{"version":3,"names":["_element","require","_classnames","_interopRequireDefault","_hooks","_blocks","_compose","_colors","_gradients","_utils","_useSetting","_inspectorControls","_colorPanel","_interopRequireWildcard","_contrastChecker","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","COLOR_SUPPORT_KEY","exports","hasColorSupport","blockType","colorSupport","getBlockSupport","link","gradient","background","text","hasLinkColorSupport","Platform","OS","hasGradientSupport","gradients","hasBackgroundColorSupport","hasTextColorSupport","addAttributes","settings","attributes","backgroundColor","assign","type","textColor","addSaveProps","props","shouldSkipSerialization","hasGradient","style","shouldSerialize","feature","textClass","getColorClassName","undefined","gradientClass","__experimentalGetGradientClass","backgroundClass","serializeHasBackground","hasBackground","color","newClassName","classnames","className","elements","addEditProps","existingGetEditWrapperProps","getEditWrapperProps","styleToAttributes","textColorValue","textColorSlug","startsWith","substring","length","backgroundColorValue","backgroundColorSlug","gradientValue","gradientSlug","updatedStyle","cleanEmptyObject","attributesToStyle","ColorInspectorControl","children","resetAllFilter","attributesResetAllFilter","useCallback","existingStyle","createElement","group","ColorEdit","clientId","name","setAttributes","useBlockSettings","isEnabled","useHasColorPanel","value","useMemo","onChange","newStyle","defaultControls","enableContrastChecking","as","panelId","enableContrastChecker","withColorPaletteStyles","createHigherOrderComponent","BlockListBlock","userPalette","useSetting","themePalette","defaultPalette","colors","extraStyles","getColorObjectByAttributeValues","wrapperProps","MIGRATION_PATHS","linkColor","addTransforms","result","source","index","results","destinationBlockType","activeSupports","transformStyles","addFilter"],"sources":["@wordpress/block-editor/src/hooks/color.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { addFilter } from '@wordpress/hooks';\nimport { getBlockSupport } from '@wordpress/blocks';\nimport { useMemo, Platform, useCallback } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport {\n\tgetColorClassName,\n\tgetColorObjectByAttributeValues,\n} from '../components/colors';\nimport { __experimentalGetGradientClass } from '../components/gradients';\nimport {\n\tcleanEmptyObject,\n\ttransformStyles,\n\tshouldSkipSerialization,\n\tuseBlockSettings,\n} from './utils';\nimport useSetting from '../components/use-setting';\nimport InspectorControls from '../components/inspector-controls';\nimport {\n\tuseHasColorPanel,\n\tdefault as StylesColorPanel,\n} from '../components/global-styles/color-panel';\nimport BlockColorContrastChecker from './contrast-checker';\n\nexport const COLOR_SUPPORT_KEY = 'color';\n\nconst hasColorSupport = ( blockType ) => {\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\treturn (\n\t\tcolorSupport &&\n\t\t( colorSupport.link === true ||\n\t\t\tcolorSupport.gradient === true ||\n\t\t\tcolorSupport.background !== false ||\n\t\t\tcolorSupport.text !== false )\n\t);\n};\n\nconst hasLinkColorSupport = ( blockType ) => {\n\tif ( Platform.OS !== 'web' ) {\n\t\treturn false;\n\t}\n\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn (\n\t\tcolorSupport !== null &&\n\t\ttypeof colorSupport === 'object' &&\n\t\t!! colorSupport.link\n\t);\n};\n\nconst hasGradientSupport = ( blockType ) => {\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn (\n\t\tcolorSupport !== null &&\n\t\ttypeof colorSupport === 'object' &&\n\t\t!! colorSupport.gradients\n\t);\n};\n\nconst hasBackgroundColorSupport = ( blockType ) => {\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn colorSupport && colorSupport.background !== false;\n};\n\nconst hasTextColorSupport = ( blockType ) => {\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn colorSupport && colorSupport.text !== false;\n};\n\n/**\n * Filters registered block settings, extending attributes to include\n * `backgroundColor` and `textColor` attribute.\n *\n * @param {Object} settings Original block settings.\n *\n * @return {Object} Filtered block settings.\n */\nfunction addAttributes( settings ) {\n\tif ( ! hasColorSupport( settings ) ) {\n\t\treturn settings;\n\t}\n\n\t// Allow blocks to specify their own attribute definition with default values if needed.\n\tif ( ! settings.attributes.backgroundColor ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\tbackgroundColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\tif ( ! settings.attributes.textColor ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\ttextColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\n\tif ( hasGradientSupport( settings ) && ! settings.attributes.gradient ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\tgradient: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\n\treturn settings;\n}\n\n/**\n * Override props assigned to save component to inject colors classnames.\n *\n * @param {Object} props      Additional props applied to save element.\n * @param {Object} blockType  Block type.\n * @param {Object} attributes Block attributes.\n *\n * @return {Object} Filtered props applied to save element.\n */\nexport function addSaveProps( props, blockType, attributes ) {\n\tif (\n\t\t! hasColorSupport( blockType ) ||\n\t\tshouldSkipSerialization( blockType, COLOR_SUPPORT_KEY )\n\t) {\n\t\treturn props;\n\t}\n\n\tconst hasGradient = hasGradientSupport( blockType );\n\n\t// I'd have preferred to avoid the \"style\" attribute usage here\n\tconst { backgroundColor, textColor, gradient, style } = attributes;\n\n\tconst shouldSerialize = ( feature ) =>\n\t\t! shouldSkipSerialization( blockType, COLOR_SUPPORT_KEY, feature );\n\n\t// Primary color classes must come before the `has-text-color`,\n\t// `has-background` and `has-link-color` classes to maintain backwards\n\t// compatibility and avoid block invalidations.\n\tconst textClass = shouldSerialize( 'text' )\n\t\t? getColorClassName( 'color', textColor )\n\t\t: undefined;\n\n\tconst gradientClass = shouldSerialize( 'gradients' )\n\t\t? __experimentalGetGradientClass( gradient )\n\t\t: undefined;\n\n\tconst backgroundClass = shouldSerialize( 'background' )\n\t\t? getColorClassName( 'background-color', backgroundColor )\n\t\t: undefined;\n\n\tconst serializeHasBackground =\n\t\tshouldSerialize( 'background' ) || shouldSerialize( 'gradients' );\n\tconst hasBackground =\n\t\tbackgroundColor ||\n\t\tstyle?.color?.background ||\n\t\t( hasGradient && ( gradient || style?.color?.gradient ) );\n\n\tconst newClassName = classnames(\n\t\tprops.className,\n\t\ttextClass,\n\t\tgradientClass,\n\t\t{\n\t\t\t// Don't apply the background class if there's a custom gradient.\n\t\t\t[ backgroundClass ]:\n\t\t\t\t( ! hasGradient || ! style?.color?.gradient ) &&\n\t\t\t\t!! backgroundClass,\n\t\t\t'has-text-color':\n\t\t\t\tshouldSerialize( 'text' ) &&\n\t\t\t\t( textColor || style?.color?.text ),\n\t\t\t'has-background': serializeHasBackground && hasBackground,\n\t\t\t'has-link-color':\n\t\t\t\tshouldSerialize( 'link' ) && style?.elements?.link?.color,\n\t\t}\n\t);\n\tprops.className = newClassName ? newClassName : undefined;\n\n\treturn props;\n}\n\n/**\n * Filters registered block settings to extend the block edit wrapper\n * to apply the desired styles and classnames properly.\n *\n * @param {Object} settings Original block settings.\n *\n * @return {Object} Filtered block settings.\n */\nexport function addEditProps( settings ) {\n\tif (\n\t\t! hasColorSupport( settings ) ||\n\t\tshouldSkipSerialization( settings, COLOR_SUPPORT_KEY )\n\t) {\n\t\treturn settings;\n\t}\n\tconst existingGetEditWrapperProps = settings.getEditWrapperProps;\n\tsettings.getEditWrapperProps = ( attributes ) => {\n\t\tlet props = {};\n\t\tif ( existingGetEditWrapperProps ) {\n\t\t\tprops = existingGetEditWrapperProps( attributes );\n\t\t}\n\t\treturn addSaveProps( props, settings, attributes );\n\t};\n\n\treturn settings;\n}\n\nfunction styleToAttributes( style ) {\n\tconst textColorValue = style?.color?.text;\n\tconst textColorSlug = textColorValue?.startsWith( 'var:preset|color|' )\n\t\t? textColorValue.substring( 'var:preset|color|'.length )\n\t\t: undefined;\n\tconst backgroundColorValue = style?.color?.background;\n\tconst backgroundColorSlug = backgroundColorValue?.startsWith(\n\t\t'var:preset|color|'\n\t)\n\t\t? backgroundColorValue.substring( 'var:preset|color|'.length )\n\t\t: undefined;\n\tconst gradientValue = style?.color?.gradient;\n\tconst gradientSlug = gradientValue?.startsWith( 'var:preset|gradient|' )\n\t\t? gradientValue.substring( 'var:preset|gradient|'.length )\n\t\t: undefined;\n\tconst updatedStyle = { ...style };\n\tupdatedStyle.color = {\n\t\t...updatedStyle.color,\n\t\ttext: textColorSlug ? undefined : textColorValue,\n\t\tbackground: backgroundColorSlug ? undefined : backgroundColorValue,\n\t\tgradient: gradientSlug ? undefined : gradientValue,\n\t};\n\treturn {\n\t\tstyle: cleanEmptyObject( updatedStyle ),\n\t\ttextColor: textColorSlug,\n\t\tbackgroundColor: backgroundColorSlug,\n\t\tgradient: gradientSlug,\n\t};\n}\n\nfunction attributesToStyle( attributes ) {\n\treturn {\n\t\t...attributes.style,\n\t\tcolor: {\n\t\t\t...attributes.style?.color,\n\t\t\ttext: attributes.textColor\n\t\t\t\t? 'var:preset|color|' + attributes.textColor\n\t\t\t\t: attributes.style?.color?.text,\n\t\t\tbackground: attributes.backgroundColor\n\t\t\t\t? 'var:preset|color|' + attributes.backgroundColor\n\t\t\t\t: attributes.style?.color?.background,\n\t\t\tgradient: attributes.gradient\n\t\t\t\t? 'var:preset|gradient|' + attributes.gradient\n\t\t\t\t: attributes.style?.color?.gradient,\n\t\t},\n\t};\n}\n\nfunction ColorInspectorControl( { children, resetAllFilter } ) {\n\tconst attributesResetAllFilter = useCallback(\n\t\t( attributes ) => {\n\t\t\tconst existingStyle = attributesToStyle( attributes );\n\t\t\tconst updatedStyle = resetAllFilter( existingStyle );\n\t\t\treturn {\n\t\t\t\t...attributes,\n\t\t\t\t...styleToAttributes( updatedStyle ),\n\t\t\t};\n\t\t},\n\t\t[ resetAllFilter ]\n\t);\n\n\treturn (\n\t\t<InspectorControls\n\t\t\tgroup=\"color\"\n\t\t\tresetAllFilter={ attributesResetAllFilter }\n\t\t>\n\t\t\t{ children }\n\t\t</InspectorControls>\n\t);\n}\n\nexport function ColorEdit( props ) {\n\tconst { clientId, name, attributes, setAttributes } = props;\n\tconst settings = useBlockSettings( name );\n\tconst isEnabled = useHasColorPanel( settings );\n\tconst value = useMemo( () => {\n\t\treturn attributesToStyle( {\n\t\t\tstyle: attributes.style,\n\t\t\ttextColor: attributes.textColor,\n\t\t\tbackgroundColor: attributes.backgroundColor,\n\t\t\tgradient: attributes.gradient,\n\t\t} );\n\t}, [\n\t\tattributes.style,\n\t\tattributes.textColor,\n\t\tattributes.backgroundColor,\n\t\tattributes.gradient,\n\t] );\n\n\tconst onChange = ( newStyle ) => {\n\t\tsetAttributes( styleToAttributes( newStyle ) );\n\t};\n\n\tif ( ! isEnabled ) {\n\t\treturn null;\n\t}\n\n\tconst defaultControls = getBlockSupport( props.name, [\n\t\tCOLOR_SUPPORT_KEY,\n\t\t'__experimentalDefaultControls',\n\t] );\n\n\tconst enableContrastChecking =\n\t\tPlatform.OS === 'web' &&\n\t\t! value?.color?.gradient &&\n\t\t( settings?.color?.text || settings?.color?.link ) &&\n\t\t// Contrast checking is enabled by default.\n\t\t// Deactivating it requires `enableContrastChecker` to have\n\t\t// an explicit value of `false`.\n\t\tfalse !==\n\t\t\tgetBlockSupport( props.name, [\n\t\t\t\tCOLOR_SUPPORT_KEY,\n\t\t\t\t'enableContrastChecker',\n\t\t\t] );\n\n\treturn (\n\t\t<StylesColorPanel\n\t\t\tas={ ColorInspectorControl }\n\t\t\tpanelId={ clientId }\n\t\t\tsettings={ settings }\n\t\t\tvalue={ value }\n\t\t\tonChange={ onChange }\n\t\t\tdefaultControls={ defaultControls }\n\t\t\tenableContrastChecker={\n\t\t\t\tfalse !==\n\t\t\t\tgetBlockSupport( props.name, [\n\t\t\t\t\tCOLOR_SUPPORT_KEY,\n\t\t\t\t\t'enableContrastChecker',\n\t\t\t\t] )\n\t\t\t}\n\t\t>\n\t\t\t{ enableContrastChecking && (\n\t\t\t\t<BlockColorContrastChecker clientId={ clientId } />\n\t\t\t) }\n\t\t</StylesColorPanel>\n\t);\n}\n\n/**\n * This adds inline styles for color palette colors.\n * Ideally, this is not needed and themes should load their palettes on the editor.\n *\n * @param {Function} BlockListBlock Original component.\n *\n * @return {Function} Wrapped component.\n */\nexport const withColorPaletteStyles = createHigherOrderComponent(\n\t( BlockListBlock ) => ( props ) => {\n\t\tconst { name, attributes } = props;\n\t\tconst { backgroundColor, textColor } = attributes;\n\t\tconst userPalette = useSetting( 'color.palette.custom' );\n\t\tconst themePalette = useSetting( 'color.palette.theme' );\n\t\tconst defaultPalette = useSetting( 'color.palette.default' );\n\t\tconst colors = useMemo(\n\t\t\t() => [\n\t\t\t\t...( userPalette || [] ),\n\t\t\t\t...( themePalette || [] ),\n\t\t\t\t...( defaultPalette || [] ),\n\t\t\t],\n\t\t\t[ userPalette, themePalette, defaultPalette ]\n\t\t);\n\t\tif (\n\t\t\t! hasColorSupport( name ) ||\n\t\t\tshouldSkipSerialization( name, COLOR_SUPPORT_KEY )\n\t\t) {\n\t\t\treturn <BlockListBlock { ...props } />;\n\t\t}\n\t\tconst extraStyles = {};\n\n\t\tif (\n\t\t\ttextColor &&\n\t\t\t! shouldSkipSerialization( name, COLOR_SUPPORT_KEY, 'text' )\n\t\t) {\n\t\t\textraStyles.color = getColorObjectByAttributeValues(\n\t\t\t\tcolors,\n\t\t\t\ttextColor\n\t\t\t)?.color;\n\t\t}\n\t\tif (\n\t\t\tbackgroundColor &&\n\t\t\t! shouldSkipSerialization( name, COLOR_SUPPORT_KEY, 'background' )\n\t\t) {\n\t\t\textraStyles.backgroundColor = getColorObjectByAttributeValues(\n\t\t\t\tcolors,\n\t\t\t\tbackgroundColor\n\t\t\t)?.color;\n\t\t}\n\n\t\tlet wrapperProps = props.wrapperProps;\n\t\twrapperProps = {\n\t\t\t...props.wrapperProps,\n\t\t\tstyle: {\n\t\t\t\t...extraStyles,\n\t\t\t\t...props.wrapperProps?.style,\n\t\t\t},\n\t\t};\n\n\t\treturn <BlockListBlock { ...props } wrapperProps={ wrapperProps } />;\n\t},\n\t'withColorPaletteStyles'\n);\n\nconst MIGRATION_PATHS = {\n\tlinkColor: [ [ 'style', 'elements', 'link', 'color', 'text' ] ],\n\ttextColor: [ [ 'textColor' ], [ 'style', 'color', 'text' ] ],\n\tbackgroundColor: [\n\t\t[ 'backgroundColor' ],\n\t\t[ 'style', 'color', 'background' ],\n\t],\n\tgradient: [ [ 'gradient' ], [ 'style', 'color', 'gradient' ] ],\n};\n\nexport function addTransforms( result, source, index, results ) {\n\tconst destinationBlockType = result.name;\n\tconst activeSupports = {\n\t\tlinkColor: hasLinkColorSupport( destinationBlockType ),\n\t\ttextColor: hasTextColorSupport( destinationBlockType ),\n\t\tbackgroundColor: hasBackgroundColorSupport( destinationBlockType ),\n\t\tgradient: hasGradientSupport( destinationBlockType ),\n\t};\n\treturn transformStyles(\n\t\tactiveSupports,\n\t\tMIGRATION_PATHS,\n\t\tresult,\n\t\tsource,\n\t\tindex,\n\t\tresults\n\t);\n}\n\naddFilter(\n\t'blocks.registerBlockType',\n\t'core/color/addAttribute',\n\taddAttributes\n);\n\naddFilter(\n\t'blocks.getSaveContent.extraProps',\n\t'core/color/addSaveProps',\n\taddSaveProps\n);\n\naddFilter(\n\t'blocks.registerBlockType',\n\t'core/color/addEditProps',\n\taddEditProps\n);\n\naddFilter(\n\t'editor.BlockListBlock',\n\t'core/color/with-color-palette-styles',\n\twithColorPaletteStyles\n);\n\naddFilter(\n\t'blocks.switchToBlockType.transformedBlock',\n\t'core/color/addTransforms',\n\taddTransforms\n);\n"],"mappings":"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"}