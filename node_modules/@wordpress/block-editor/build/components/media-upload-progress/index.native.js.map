{"version":3,"names":["_element","require","_reactNative","_components","_i18n","_reactNativeBridge","_styles","_interopRequireDefault","MEDIA_UPLOAD_STATE_UPLOADING","exports","MEDIA_UPLOAD_STATE_SUCCEEDED","MEDIA_UPLOAD_STATE_FAILED","MEDIA_UPLOAD_STATE_RESET","MediaUploadProgress","Component","constructor","props","state","progress","isUploadInProgress","isUploadFailed","mediaUpload","bind","componentDidMount","addMediaUploadListener","componentWillUnmount","removeMediaUploadListener","payload","mediaId","updateMediaProgress","finishMediaUploadWithSuccess","finishMediaUploadWithFailure","mediaUploadStateReset","setState","onUpdateMediaProgress","onFinishMediaUploadWithSuccess","onFinishMediaUploadWithFailure","onMediaUploadStateReset","subscriptionParentMediaUpload","subscribeMediaUpload","remove","render","renderContent","showSpinner","retryMessage","__","progressBarStyle","styles","progressBar","progressBarHidden","createElement","View","style","mediaUploadProgress","containerStyle","pointerEvents","Spinner","spinnerStyle","testID","_default","default"],"sources":["@wordpress/block-editor/src/components/media-upload-progress/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { View } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { Spinner } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { subscribeMediaUpload } from '@wordpress/react-native-bridge';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\n\nexport const MEDIA_UPLOAD_STATE_UPLOADING = 1;\nexport const MEDIA_UPLOAD_STATE_SUCCEEDED = 2;\nexport const MEDIA_UPLOAD_STATE_FAILED = 3;\nexport const MEDIA_UPLOAD_STATE_RESET = 4;\n\nexport class MediaUploadProgress extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.state = {\n\t\t\tprogress: 0,\n\t\t\tisUploadInProgress: false,\n\t\t\tisUploadFailed: false,\n\t\t};\n\n\t\tthis.mediaUpload = this.mediaUpload.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.addMediaUploadListener();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.removeMediaUploadListener();\n\t}\n\n\tmediaUpload( payload ) {\n\t\tconst { mediaId } = this.props;\n\n\t\tif ( payload.mediaId !== mediaId ) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch ( payload.state ) {\n\t\t\tcase MEDIA_UPLOAD_STATE_UPLOADING:\n\t\t\t\tthis.updateMediaProgress( payload );\n\t\t\t\tbreak;\n\t\t\tcase MEDIA_UPLOAD_STATE_SUCCEEDED:\n\t\t\t\tthis.finishMediaUploadWithSuccess( payload );\n\t\t\t\tbreak;\n\t\t\tcase MEDIA_UPLOAD_STATE_FAILED:\n\t\t\t\tthis.finishMediaUploadWithFailure( payload );\n\t\t\t\tbreak;\n\t\t\tcase MEDIA_UPLOAD_STATE_RESET:\n\t\t\t\tthis.mediaUploadStateReset( payload );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tupdateMediaProgress( payload ) {\n\t\tthis.setState( {\n\t\t\tprogress: payload.progress,\n\t\t\tisUploadInProgress: true,\n\t\t\tisUploadFailed: false,\n\t\t} );\n\t\tif ( this.props.onUpdateMediaProgress ) {\n\t\t\tthis.props.onUpdateMediaProgress( payload );\n\t\t}\n\t}\n\n\tfinishMediaUploadWithSuccess( payload ) {\n\t\tthis.setState( { isUploadInProgress: false } );\n\t\tif ( this.props.onFinishMediaUploadWithSuccess ) {\n\t\t\tthis.props.onFinishMediaUploadWithSuccess( payload );\n\t\t}\n\t}\n\n\tfinishMediaUploadWithFailure( payload ) {\n\t\tthis.setState( { isUploadInProgress: false, isUploadFailed: true } );\n\t\tif ( this.props.onFinishMediaUploadWithFailure ) {\n\t\t\tthis.props.onFinishMediaUploadWithFailure( payload );\n\t\t}\n\t}\n\n\tmediaUploadStateReset( payload ) {\n\t\tthis.setState( { isUploadInProgress: false, isUploadFailed: false } );\n\t\tif ( this.props.onMediaUploadStateReset ) {\n\t\t\tthis.props.onMediaUploadStateReset( payload );\n\t\t}\n\t}\n\n\taddMediaUploadListener() {\n\t\t// If we already have a subscription not worth doing it again.\n\t\tif ( this.subscriptionParentMediaUpload ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.subscriptionParentMediaUpload = subscribeMediaUpload(\n\t\t\t( payload ) => {\n\t\t\t\tthis.mediaUpload( payload );\n\t\t\t}\n\t\t);\n\t}\n\n\tremoveMediaUploadListener() {\n\t\tif ( this.subscriptionParentMediaUpload ) {\n\t\t\tthis.subscriptionParentMediaUpload.remove();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { renderContent = () => null } = this.props;\n\t\tconst { isUploadInProgress, isUploadFailed } = this.state;\n\t\tconst showSpinner = this.state.isUploadInProgress;\n\t\tconst progress = this.state.progress * 100;\n\t\t// eslint-disable-next-line @wordpress/i18n-no-collapsible-whitespace\n\t\tconst retryMessage = __(\n\t\t\t'Failed to insert media.\\nTap for more info.'\n\t\t);\n\n\t\tconst progressBarStyle = [\n\t\t\tstyles.progressBar,\n\t\t\tshowSpinner || styles.progressBarHidden,\n\t\t\tthis.props.progressBarStyle,\n\t\t];\n\n\t\treturn (\n\t\t\t<View\n\t\t\t\tstyle={ [\n\t\t\t\t\tstyles.mediaUploadProgress,\n\t\t\t\t\tthis.props.containerStyle,\n\t\t\t\t] }\n\t\t\t\tpointerEvents=\"box-none\"\n\t\t\t>\n\t\t\t\t<View style={ progressBarStyle }>\n\t\t\t\t\t{ showSpinner && (\n\t\t\t\t\t\t<Spinner\n\t\t\t\t\t\t\tprogress={ progress }\n\t\t\t\t\t\t\tstyle={ this.props.spinnerStyle }\n\t\t\t\t\t\t\ttestID=\"spinner\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</View>\n\t\t\t\t{ renderContent( {\n\t\t\t\t\tisUploadInProgress,\n\t\t\t\t\tisUploadFailed,\n\t\t\t\t\tretryMessage,\n\t\t\t\t} ) }\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default MediaUploadProgress;\n"],"mappings":"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"}