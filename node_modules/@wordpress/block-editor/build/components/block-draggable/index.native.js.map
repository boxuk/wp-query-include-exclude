{"version":3,"names":["_element","require","_reactNative","_reactNativeSafeAreaContext","_reactNativeReanimated","_interopRequireWildcard","_components","_data","_blocks","_reactNativeBridge","_reactNativeAztec","_interopRequireDefault","_useScrollWhenDragging","_draggableChip","_store","_blockListContext","_droppingInsertionPoint","_useBlockDropZone","_style","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","CHIP_OFFSET_TO_TOUCH_POSITION","BLOCK_OPACITY_ANIMATION_CONFIG","duration","BLOCK_OPACITY_ANIMATION_DELAY","DEFAULT_LONG_PRESS_MIN_DURATION","DEFAULT_IOS_LONG_PRESS_MIN_DURATION","BlockDraggableWrapper","children","isRTL","draggedBlockIcon","setDraggedBlockIcon","useState","selectBlock","startDraggingBlocks","stopDraggingBlocks","useDispatch","blockEditorStore","scrollRef","useBlockListContext","animatedScrollRef","useAnimatedRef","left","right","useSafeAreaInsets","width","useSafeAreaFrame","safeAreaOffset","contentWidth","scroll","offsetY","useSharedValue","chip","x","y","height","currentYPosition","isDragging","startScrolling","scrollOnDragOver","stopScrolling","draggingScrollHandler","useScrollWhenDragging","scrollHandler","event","contentOffset","value","onBlockDragOverWorklet","onBlockDragEnd","onBlockDrop","targetBlockIndex","useBlockDropZone","useEffect","setDraggedBlockIconByClientId","clientId","blockName","select","getBlockName","blockIcon","getBlockType","icon","onStartDragging","position","runOnUI","generateHapticFeedback","stopDragging","onStopDragging","srcRootClientId","srcClientIds","type","undefined","onChipLayout","nativeEvent","layout","startDragging","id","dragPosition","runOnJS","updateDragging","chipDynamicStyles","useAnimatedStyle","chipOffset","translateX","transform","translateY","chipStyles","styles","exitingAnimation","currentHeight","currentWidth","animations","withTiming","scale","initialValues","createElement","Fragment","Draggable","onDragStart","onDragOver","onDragEnd","testID","onScroll","View","onLayout","style","pointerEvents","entering","ZoomInEasyDown","exiting","exports","useIsScreenReaderEnabled","isScreenReaderEnabled","setIsScreenReaderEnabled","mounted","changeListener","AccessibilityInfo","addEventListener","enabled","then","screenReaderEnabled","remove","useIsEditingText","isEditingText","setIsEditingText","RCTAztecView","InputState","isFocused","onFocusChangeAztec","addFocusChangeListener","removeFocusChangeListener","BlockDraggable","draggingClientId","wasBeingDragged","useRef","draggingAnimation","opacity","startDraggingBlock","stopDraggingBlock","withDelay","isDraggable","isBeingDragged","isBlockSelected","useSelect","_select","getBlockRootClientId","getTemplateLock","isBlockBeingDragged","getSelectedBlockClientId","rootClientId","templateLock","selectedBlockClientId","current","onLongPressDraggable","useCallback","blurCurrentFocusedElement","animatedWrapperStyles","wrapperStyles","canDragBlock","DraggableTrigger","minDuration","Platform","ios","android","onLongPress","_default"],"sources":["@wordpress/block-editor/src/components/block-draggable/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { AccessibilityInfo } from 'react-native';\nimport {\n\tuseSafeAreaInsets,\n\tuseSafeAreaFrame,\n} from 'react-native-safe-area-context';\nimport Animated, {\n\trunOnJS,\n\trunOnUI,\n\tuseAnimatedRef,\n\tuseAnimatedStyle,\n\tuseSharedValue,\n\twithDelay,\n\twithTiming,\n\tZoomInEasyDown,\n} from 'react-native-reanimated';\n\n/**\n * WordPress dependencies\n */\nimport { Draggable, DraggableTrigger } from '@wordpress/components';\nimport { select, useSelect, useDispatch } from '@wordpress/data';\nimport {\n\tuseCallback,\n\tuseEffect,\n\tuseRef,\n\tuseState,\n\tPlatform,\n} from '@wordpress/element';\nimport { getBlockType } from '@wordpress/blocks';\nimport { generateHapticFeedback } from '@wordpress/react-native-bridge';\nimport RCTAztecView from '@wordpress/react-native-aztec';\n\n/**\n * Internal dependencies\n */\nimport useScrollWhenDragging from './use-scroll-when-dragging';\nimport DraggableChip from './draggable-chip';\nimport { store as blockEditorStore } from '../../store';\nimport { useBlockListContext } from '../block-list/block-list-context';\nimport DroppingInsertionPoint from './dropping-insertion-point';\nimport useBlockDropZone from '../use-block-drop-zone';\nimport styles from './style.scss';\n\nconst CHIP_OFFSET_TO_TOUCH_POSITION = 32;\nconst BLOCK_OPACITY_ANIMATION_CONFIG = { duration: 350 };\nconst BLOCK_OPACITY_ANIMATION_DELAY = 250;\nconst DEFAULT_LONG_PRESS_MIN_DURATION = 500;\nconst DEFAULT_IOS_LONG_PRESS_MIN_DURATION =\n\tDEFAULT_LONG_PRESS_MIN_DURATION - 50;\n\n/**\n * Block draggable wrapper component\n *\n * This component handles all the interactions for dragging blocks.\n * It relies on the block list and its context for dragging, hence it\n * should be rendered between the `BlockListProvider` component and the\n * block list rendering. It also requires listening to scroll events,\n * therefore for this purpose, it returns the `onScroll` event handler\n * that should be attached to the list that renders the blocks.\n *\n *\n * @param {Object}      props          Component props.\n * @param {JSX.Element} props.children Children to be rendered.\n * @param {boolean}     props.isRTL    Check if current locale is RTL.\n *\n * @return {Function} Render function that passes `onScroll` event handler.\n */\nconst BlockDraggableWrapper = ( { children, isRTL } ) => {\n\tconst [ draggedBlockIcon, setDraggedBlockIcon ] = useState();\n\n\tconst { selectBlock, startDraggingBlocks, stopDraggingBlocks } =\n\t\tuseDispatch( blockEditorStore );\n\n\tconst { scrollRef } = useBlockListContext();\n\tconst animatedScrollRef = useAnimatedRef();\n\tconst { left, right } = useSafeAreaInsets();\n\tconst { width } = useSafeAreaFrame();\n\tconst safeAreaOffset = left + right;\n\tconst contentWidth = width - safeAreaOffset;\n\tanimatedScrollRef( scrollRef );\n\n\tconst scroll = {\n\t\toffsetY: useSharedValue( 0 ),\n\t};\n\tconst chip = {\n\t\tx: useSharedValue( 0 ),\n\t\ty: useSharedValue( 0 ),\n\t\twidth: useSharedValue( 0 ),\n\t\theight: useSharedValue( 0 ),\n\t};\n\tconst currentYPosition = useSharedValue( 0 );\n\tconst isDragging = useSharedValue( false );\n\n\tconst [\n\t\tstartScrolling,\n\t\tscrollOnDragOver,\n\t\tstopScrolling,\n\t\tdraggingScrollHandler,\n\t] = useScrollWhenDragging();\n\n\tconst scrollHandler = ( event ) => {\n\t\t'worklet';\n\t\tconst { contentOffset } = event;\n\t\tscroll.offsetY.value = contentOffset.y;\n\n\t\tdraggingScrollHandler( event );\n\t};\n\n\tconst {\n\t\tonBlockDragOverWorklet,\n\t\tonBlockDragEnd,\n\t\tonBlockDrop,\n\t\ttargetBlockIndex,\n\t} = useBlockDropZone();\n\n\t// Stop dragging blocks if the block draggable is unmounted.\n\tuseEffect( () => {\n\t\treturn () => {\n\t\t\tif ( isDragging.value ) {\n\t\t\t\tstopDraggingBlocks();\n\t\t\t}\n\t\t};\n\t}, [] );\n\n\tconst setDraggedBlockIconByClientId = ( clientId ) => {\n\t\tconst blockName = select( blockEditorStore ).getBlockName( clientId );\n\t\tconst blockIcon = getBlockType( blockName )?.icon;\n\t\tif ( blockIcon ) {\n\t\t\tsetDraggedBlockIcon( blockIcon );\n\t\t}\n\t};\n\n\tconst onStartDragging = ( { clientId, position } ) => {\n\t\tif ( clientId ) {\n\t\t\tstartDraggingBlocks( [ clientId ] );\n\t\t\tsetDraggedBlockIconByClientId( clientId );\n\t\t\trunOnUI( startScrolling )( position.y );\n\t\t\tgenerateHapticFeedback();\n\t\t} else {\n\t\t\t// We stop dragging if no block is found.\n\t\t\trunOnUI( stopDragging )();\n\t\t}\n\t};\n\n\tconst onStopDragging = ( { clientId } ) => {\n\t\tif ( clientId ) {\n\t\t\tonBlockDrop( {\n\t\t\t\t// Dropping is only allowed at root level\n\t\t\t\tsrcRootClientId: '',\n\t\t\t\tsrcClientIds: [ clientId ],\n\t\t\t\ttype: 'block',\n\t\t\t} );\n\t\t\tselectBlock( clientId );\n\t\t\tsetDraggedBlockIcon( undefined );\n\t\t}\n\t\tonBlockDragEnd();\n\t\tstopDraggingBlocks();\n\t};\n\n\tconst onChipLayout = ( { nativeEvent: { layout } } ) => {\n\t\tif ( layout.width > 0 ) {\n\t\t\tchip.width.value = layout.width;\n\t\t}\n\t\tif ( layout.height > 0 ) {\n\t\t\tchip.height.value = layout.height;\n\t\t}\n\t};\n\n\tconst startDragging = ( { x, y, id } ) => {\n\t\t'worklet';\n\t\tconst dragPosition = { x, y };\n\t\tchip.x.value = dragPosition.x;\n\t\tchip.y.value = dragPosition.y;\n\t\tcurrentYPosition.value = dragPosition.y;\n\n\t\tisDragging.value = true;\n\n\t\trunOnJS( onStartDragging )( { clientId: id, position: dragPosition } );\n\t};\n\n\tconst updateDragging = ( { x, y } ) => {\n\t\t'worklet';\n\t\tconst dragPosition = { x, y };\n\t\tchip.x.value = dragPosition.x;\n\t\tchip.y.value = dragPosition.y;\n\t\tcurrentYPosition.value = dragPosition.y;\n\n\t\tonBlockDragOverWorklet( { x, y: y + scroll.offsetY.value } );\n\n\t\t// Update scrolling velocity\n\t\tscrollOnDragOver( dragPosition.y );\n\t};\n\n\tconst stopDragging = ( { id } ) => {\n\t\t'worklet';\n\t\tisDragging.value = false;\n\n\t\tstopScrolling();\n\t\trunOnJS( onStopDragging )( { clientId: id } );\n\t};\n\n\tconst chipDynamicStyles = useAnimatedStyle( () => {\n\t\tconst chipOffset = chip.width.value / 2;\n\t\tconst translateX = ! isRTL\n\t\t\t? chip.x.value - chipOffset\n\t\t\t: -( contentWidth - ( chip.x.value + chipOffset ) );\n\n\t\treturn {\n\t\t\ttransform: [\n\t\t\t\t{\n\t\t\t\t\ttranslateX,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttranslateY:\n\t\t\t\t\t\tchip.y.value -\n\t\t\t\t\t\tchip.height.value -\n\t\t\t\t\t\tCHIP_OFFSET_TO_TOUCH_POSITION,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t} );\n\tconst chipStyles = [\n\t\tchipDynamicStyles,\n\t\tstyles[ 'draggable-chip__wrapper' ],\n\t];\n\n\tconst exitingAnimation = ( { currentHeight, currentWidth } ) => {\n\t\t'worklet';\n\t\tconst translateX = ! isRTL ? 0 : currentWidth * -1;\n\t\tconst duration = 150;\n\t\tconst animations = {\n\t\t\ttransform: [\n\t\t\t\t{\n\t\t\t\t\ttranslateY: withTiming( currentHeight, {\n\t\t\t\t\t\tduration,\n\t\t\t\t\t} ),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttranslateX: withTiming( translateX, {\n\t\t\t\t\t\tduration,\n\t\t\t\t\t} ),\n\t\t\t\t},\n\t\t\t\t{ scale: withTiming( 0, { duration } ) },\n\t\t\t],\n\t\t};\n\t\tconst initialValues = {\n\t\t\ttransform: [ { translateY: 0 }, { translateX }, { scale: 1 } ],\n\t\t};\n\t\treturn {\n\t\t\tinitialValues,\n\t\t\tanimations,\n\t\t};\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<DroppingInsertionPoint\n\t\t\t\tscroll={ scroll }\n\t\t\t\tcurrentYPosition={ currentYPosition }\n\t\t\t\tisDragging={ isDragging }\n\t\t\t\ttargetBlockIndex={ targetBlockIndex }\n\t\t\t/>\n\t\t\t<Draggable\n\t\t\t\tonDragStart={ startDragging }\n\t\t\t\tonDragOver={ updateDragging }\n\t\t\t\tonDragEnd={ stopDragging }\n\t\t\t\ttestID=\"block-draggable-wrapper\"\n\t\t\t>\n\t\t\t\t{ children( { onScroll: scrollHandler } ) }\n\t\t\t</Draggable>\n\t\t\t<Animated.View\n\t\t\t\tonLayout={ onChipLayout }\n\t\t\t\tstyle={ chipStyles }\n\t\t\t\tpointerEvents=\"none\"\n\t\t\t>\n\t\t\t\t{ draggedBlockIcon && (\n\t\t\t\t\t<Animated.View\n\t\t\t\t\t\tentering={ ZoomInEasyDown.duration( 200 ) }\n\t\t\t\t\t\texiting={ exitingAnimation }\n\t\t\t\t\t>\n\t\t\t\t\t\t<DraggableChip icon={ draggedBlockIcon } />\n\t\t\t\t\t</Animated.View>\n\t\t\t\t) }\n\t\t\t</Animated.View>\n\t\t</>\n\t);\n};\n\nfunction useIsScreenReaderEnabled() {\n\tconst [ isScreenReaderEnabled, setIsScreenReaderEnabled ] =\n\t\tuseState( false );\n\n\tuseEffect( () => {\n\t\tlet mounted = true;\n\n\t\tconst changeListener = AccessibilityInfo.addEventListener(\n\t\t\t'screenReaderChanged',\n\t\t\t( enabled ) => setIsScreenReaderEnabled( enabled )\n\t\t);\n\n\t\tAccessibilityInfo.isScreenReaderEnabled().then(\n\t\t\t( screenReaderEnabled ) => {\n\t\t\t\tif ( mounted && screenReaderEnabled ) {\n\t\t\t\t\tsetIsScreenReaderEnabled( screenReaderEnabled );\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\treturn () => {\n\t\t\tmounted = false;\n\n\t\t\tchangeListener.remove();\n\t\t};\n\t}, [] );\n\n\treturn isScreenReaderEnabled;\n}\n\nfunction useIsEditingText() {\n\tconst [ isEditingText, setIsEditingText ] = useState( () =>\n\t\tRCTAztecView.InputState.isFocused()\n\t);\n\n\tuseEffect( () => {\n\t\tconst onFocusChangeAztec = ( { isFocused } ) => {\n\t\t\tsetIsEditingText( isFocused );\n\t\t};\n\n\t\tRCTAztecView.InputState.addFocusChangeListener( onFocusChangeAztec );\n\n\t\treturn () => {\n\t\t\tRCTAztecView.InputState.removeFocusChangeListener(\n\t\t\t\tonFocusChangeAztec\n\t\t\t);\n\t\t};\n\t}, [] );\n\n\treturn isEditingText;\n}\n\n/**\n * Block draggable component\n *\n * This component serves for animating the block when it is being dragged.\n * Hence, it should be wrapped around the rendering of a block.\n *\n * @param {Object}      props                    Component props.\n * @param {JSX.Element} props.children           Children to be rendered.\n * @param {string}      props.clientId           Client id of the block.\n * @param {string}      [props.draggingClientId] Client id to use for dragging. If not defined, the value from `clientId` will be used.\n * @param {boolean}     [props.enabled]          Enables the draggable trigger.\n * @param {string}      [props.testID]           Id used for querying the long-press gesture handler in tests.\n *\n * @return {Function} Render function which includes the parameter `isDraggable` to determine if the block can be dragged.\n */\nconst BlockDraggable = ( {\n\tclientId,\n\tchildren,\n\tdraggingClientId,\n\tenabled = true,\n\ttestID,\n} ) => {\n\tconst wasBeingDragged = useRef( false );\n\tconst isEditingText = useIsEditingText();\n\tconst isScreenReaderEnabled = useIsScreenReaderEnabled();\n\n\tconst draggingAnimation = {\n\t\topacity: useSharedValue( 1 ),\n\t};\n\n\tconst startDraggingBlock = () => {\n\t\tdraggingAnimation.opacity.value = withTiming(\n\t\t\t0.4,\n\t\t\tBLOCK_OPACITY_ANIMATION_CONFIG\n\t\t);\n\t};\n\n\tconst stopDraggingBlock = () => {\n\t\tdraggingAnimation.opacity.value = withDelay(\n\t\t\tBLOCK_OPACITY_ANIMATION_DELAY,\n\t\t\twithTiming( 1, BLOCK_OPACITY_ANIMATION_CONFIG )\n\t\t);\n\t};\n\n\tconst { isDraggable, isBeingDragged, isBlockSelected } = useSelect(\n\t\t( _select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockRootClientId,\n\t\t\t\tgetTemplateLock,\n\t\t\t\tisBlockBeingDragged,\n\t\t\t\tgetSelectedBlockClientId,\n\t\t\t} = _select( blockEditorStore );\n\t\t\tconst rootClientId = getBlockRootClientId( clientId );\n\t\t\tconst templateLock = rootClientId\n\t\t\t\t? getTemplateLock( rootClientId )\n\t\t\t\t: null;\n\t\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\n\t\t\treturn {\n\t\t\t\tisBeingDragged: isBlockBeingDragged( clientId ),\n\t\t\t\tisDraggable: 'all' !== templateLock,\n\t\t\t\tisBlockSelected:\n\t\t\t\t\tselectedBlockClientId && selectedBlockClientId === clientId,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tuseEffect( () => {\n\t\tif ( isBeingDragged !== wasBeingDragged.current ) {\n\t\t\tif ( isBeingDragged ) {\n\t\t\t\tstartDraggingBlock();\n\t\t\t} else {\n\t\t\t\tstopDraggingBlock();\n\t\t\t}\n\t\t}\n\t\twasBeingDragged.current = isBeingDragged;\n\t}, [ isBeingDragged ] );\n\n\tconst onLongPressDraggable = useCallback( () => {\n\t\t// Ensure that no text input is focused when starting the dragging gesture in order to prevent conflicts with text editing.\n\t\tRCTAztecView.InputState.blurCurrentFocusedElement();\n\t}, [] );\n\n\tconst animatedWrapperStyles = useAnimatedStyle( () => {\n\t\treturn {\n\t\t\topacity: draggingAnimation.opacity.value,\n\t\t};\n\t} );\n\tconst wrapperStyles = [\n\t\tanimatedWrapperStyles,\n\t\tstyles[ 'draggable-wrapper__container' ],\n\t];\n\n\tconst canDragBlock =\n\t\tenabled &&\n\t\t! isScreenReaderEnabled &&\n\t\t( ! isBlockSelected || ! isEditingText );\n\n\tif ( ! isDraggable ) {\n\t\treturn children( { isDraggable: false } );\n\t}\n\n\treturn (\n\t\t<DraggableTrigger\n\t\t\tid={ draggingClientId || clientId }\n\t\t\tenabled={ enabled && canDragBlock }\n\t\t\tminDuration={ Platform.select( {\n\t\t\t\t// On iOS, using a lower min duration than the default\n\t\t\t\t// value prevents the long-press gesture from being\n\t\t\t\t// triggered in underneath elements. This is required to\n\t\t\t\t// prevent enabling text editing when dragging is available.\n\t\t\t\tios: canDragBlock\n\t\t\t\t\t? DEFAULT_IOS_LONG_PRESS_MIN_DURATION\n\t\t\t\t\t: DEFAULT_LONG_PRESS_MIN_DURATION,\n\t\t\t\tandroid: DEFAULT_LONG_PRESS_MIN_DURATION,\n\t\t\t} ) }\n\t\t\tonLongPress={ onLongPressDraggable }\n\t\t\ttestID={ testID }\n\t\t>\n\t\t\t<Animated.View style={ wrapperStyles }>\n\t\t\t\t{ children( { isDraggable: true } ) }\n\t\t\t</Animated.View>\n\t\t</DraggableTrigger>\n\t);\n};\n\nexport { BlockDraggableWrapper };\nexport default BlockDraggable;\n"],"mappings":"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"}