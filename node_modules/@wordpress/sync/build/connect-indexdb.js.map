{"version":3,"names":["_yIndexeddb","require","connectIndexDb","objectId","objectType","doc","docName","provider","IndexeddbPersistence","Promise","resolve","on","destroy"],"sources":["@wordpress/sync/src/connect-indexdb.js"],"sourcesContent":["/**\n * External dependencies\n */\n// @ts-ignore\nimport { IndexeddbPersistence } from 'y-indexeddb';\n\n/** @typedef {import('./types').ObjectType} ObjectType */\n/** @typedef {import('./types').ObjectID} ObjectID */\n/** @typedef {import('./types').CRDTDoc} CRDTDoc */\n/** @typedef {import('./types').ConnectDoc} ConnectDoc */\n/** @typedef {import('./types').SyncProvider} SyncProvider */\n\n/**\n * Connect function to the IndexedDB persistence provider.\n *\n * @param {ObjectID}   objectId   The object ID.\n * @param {ObjectType} objectType The object type.\n * @param {CRDTDoc}    doc        The CRDT document.\n *\n * @return {Promise<() => void>} Promise that resolves when the connection is established.\n */\nexport function connectIndexDb( objectId, objectType, doc ) {\n\tconst docName = `${ objectType }-${ objectId }`;\n\tconst provider = new IndexeddbPersistence( docName, doc );\n\n\treturn new Promise( ( resolve ) => {\n\t\tprovider.on( 'synced', () => {\n\t\t\tresolve( () => provider.destroy() );\n\t\t} );\n\t} );\n}\n"],"mappings":";;;;;;AAIA,IAAAA,WAAA,GAAAC,OAAA;AAJA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,cAAcA,CAAEC,QAAQ,EAAEC,UAAU,EAAEC,GAAG,EAAG;EAC3D,MAAMC,OAAO,GAAI,GAAGF,UAAY,IAAID,QAAU,EAAC;EAC/C,MAAMI,QAAQ,GAAG,IAAIC,gCAAoB,CAAEF,OAAO,EAAED,GAAI,CAAC;EAEzD,OAAO,IAAII,OAAO,CAAIC,OAAO,IAAM;IAClCH,QAAQ,CAACI,EAAE,CAAE,QAAQ,EAAE,MAAM;MAC5BD,OAAO,CAAE,MAAMH,QAAQ,CAACK,OAAO,CAAC,CAAE,CAAC;IACpC,CAAE,CAAC;EACJ,CAAE,CAAC;AACJ"}